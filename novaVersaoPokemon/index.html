<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Pokemons</title>
</head>

<body>
        <a href="pokedex.html">adwada</a>
    <main>
        <section id="principal"></section>

    </main>

<script src="script.js"></script>
    <script>
        const storedArray = sessionStorage.getItem('arrayPokemons');
        const arrayPokemons = storedArray ? JSON.parse(storedArray) : [];

        const storedArray1 = sessionStorage.getItem('pokedex');
        const arrayPokedex = storedArray1 ? JSON.parse(storedArray1) : [];

        window.onload = function() {
    if (arrayPokemons.length === 0) {
        teste(); // Se o array de pokémons estiver vazio, buscar os dados
    } else {
        criarDivPokemons(); // Se o array de pokémons já contiver dados, criar os elementos na página
    }
};

console.log(arrayPokemons)

        function teste() {
        fetch('https://pokeapi.co/api/v2/pokemon/')
            .then(response => response.json())
            .then(function (json) {
                const pokemonsData = json.results;

                pokemonsData.forEach(pokemon => {
                    const urlDetalhes = pokemon.url;

                    fetch(urlDetalhes)
                        .then(response => response.json())
                        .then(function (pokemonData) {
                            const nomePokemon = pokemonData.name;
                            const urlImagem = pokemonData.sprites.front_default;
                            const id = pokemonData.id;

                            // Obtendo os tipos do Pokémon
                            const tipos = pokemonData.types.map(tipo => tipo.type.name);
                            const estatiticas = pokemonData.stas.map(stats => stats.type.name);

                            addPokemon(id, nomePokemon, urlImagem, tipos);
                        })
                        .catch(err => console.log('Erro ' + err));
                });
            })
            .catch(err => console.log('Er' + err));
    }

        

        function addPokemon(id, nomePokemon, urlImagem, tipos) {
            const poke = {
                id: id,
                nome: nomePokemon,
                img: urlImagem,
                tipo: tipos
            }
            arrayPokemons.push(poke);
            sessionStorage.setItem('arrayPokemons', JSON.stringify(arrayPokemons));
            criarDivPokemons();
            console.log(`Pokemon "${poke.nome}" adicionado à lista.`);
        }

        function addPokedex(id, nome, img, tipos) {
            const pokemon = {
                id: id,
                nome: nome,
                img: img,
                tipo: tipos
            };

            arrayPokedex.push(pokemon);
            removerPokemon(id);

            sessionStorage.setItem('pokedex', JSON.stringify(arrayPokedex));
            sessionStorage.setItem('arrayPokemons', JSON.stringify(arrayPokemons));

            removerDiv(pokemon);
            console.log(`Pokemon "${pokemon.nome}" adicionado à Pokedex.`);
        }

        function criarDivPokemons() {
            const principal = document.getElementById('principal');
            principal.innerHTML = '';

            arrayPokemons.forEach(pokemon => {
                criar(pokemon, 'index');
            });
        }

        function removerPokemon(id) {
            const index = arrayPokemons.findIndex(pokemon => pokemon.id === id);

            if (index !== -1) {
                arrayPokemons.splice(index, 1);
                sessionStorage.setItem('arrayPokemons', JSON.stringify(arrayPokemons));
                criarDivPokemons();
                console.log(`Pokemon com ID ${id} removido da lista.`);
            } else {
                console.error(`Pokemon com ID ${id} não encontrado na lista.`);
            }
        }

        function removerDiv(poke) {
            const divRemover = document.getElementById(`pokemon-${poke.id}`);
            if (divRemover) {
                divRemover.remove();
                console.log(`Div do Pokemon "${poke.nome}" removida.`);
            } else {
                console.error(`Div do Pokemon "${poke.nome}" não encontrada.`);
            }
        }


       
    </script>

</body>

</html>